<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>üç∫ AlcoTracker - Quanto posso bere?</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:linear-gradient(135deg,#1a1a2e,#16213e);color:#fff;min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px}
.container{max-width:400px;width:100%;text-align:center}
h1{font-size:48px;margin-bottom:8px}
.subtitle{color:#888;margin-bottom:40px;font-size:14px}
.form{background:#ffffff11;border-radius:16px;padding:24px;backdrop-filter:blur(10px);border:1px solid #ffffff22}
input,select{width:100%;padding:14px;margin:8px 0;border-radius:10px;border:1px solid #ffffff33;background:#ffffff11;color:#fff;font-size:16px}
input::placeholder{color:#888}
select option{background:#1a1a2e;color:#fff}
.btn{width:100%;padding:16px;margin-top:16px;border-radius:10px;border:none;background:linear-gradient(135deg,#e94560,#ff6b6b);color:#fff;font-size:18px;font-weight:700;cursor:pointer;transition:transform .2s,box-shadow .2s}
.btn:hover{transform:scale(1.02);box-shadow:0 8px 25px #e9456055}
.btn:active{transform:scale(0.98)}
.info{margin-top:20px;padding:16px;background:#ffffff11;border-radius:10px;font-size:12px;color:#aaa;line-height:1.6}
.emoji{font-size:24px;margin-right:8px}
</style>
</head>
<body>

<div class="container">
  <h1>üç∫</h1>
  <h2 style="font-size:28px;margin-bottom:4px">AlcoTracker</h2>
  <p class="subtitle">Traccia il tuo tasso alcolemico in tempo reale</p>
  
  <div class="form">
    <input type="text" id="nome" placeholder="üë§ Il tuo nome" required>
    <input type="number" id="peso" placeholder="‚öñÔ∏è Peso in kg" min="40" max="200" required>
    <select id="sesso">
      <option value="">üöª Sesso</option>
      <option value="M">üë® Uomo</option>
      <option value="F">üë© Donna</option>
    </select>
    <button class="btn" onclick="registrati()">üöÄ ENTRA</button>
  </div>
  
  <div class="info">
    ‚ö†Ô∏è <strong>Disclaimer:</strong> Questa app fornisce stime indicative. 
    Il tasso alcolemico reale pu√≤ variare. Non metterti alla guida se hai dubbi!
    <br><br>
    üöó Limite legale Italia: <strong>0.5 g/L</strong> (0.0 per neopatentati)
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBxYLAaFJqFxHkZ2CVU3sFwUCEp60gis2U",
  authDomain: "copilota-6d94a.firebaseapp.com",
  databaseURL: "https://copilota-6d94a-default-rtdb.firebaseio.com",
  projectId: "copilota-6d94a"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

window.registrati = async function() {
  const nome = document.getElementById('nome').value.trim();
  const peso = parseFloat(document.getElementById('peso').value);
  const sesso = document.getElementById('sesso').value;
  
  if (!nome || !peso || !sesso) {
    alert('Compila tutti i campi!');
    return;
  }
  
  const odaId = nome.toLowerCase().replace(/[^a-z0-9]/g, '') + '_' + Date.now();
  
  const userData = {
    nome,
    peso,
    sesso,
    createdAt: Date.now(),
    drinks: {},
    food: 'medio'
  };
  
  await set(ref(db, 'alco_users/' + odaId), userData);
  localStorage.setItem('alcoTrackerId', odaId);
  localStorage.setItem('alcoTrackerName', nome);
  
  window.location.href = 'app.html';
}

// Check if already registered
const existingId = localStorage.getItem('alcoTrackerId');
if (existingId) {
  get(ref(db, 'alco_users/' + existingId)).then(snap => {
    if (snap.exists()) {
      window.location.href = 'app.html';
    }
  });
}
</script>
</body>
</html>
