<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>ğŸº AlcoTracker</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,sans-serif;background:linear-gradient(135deg,#1a1a2e,#16213e);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
.box{max-width:360px;width:100%;text-align:center}
.logo{font-size:64px;margin-bottom:8px}
h1{font-size:28px;margin-bottom:4px}
.sub{color:#888;margin-bottom:32px;font-size:14px}
.form{background:#ffffff11;border-radius:20px;padding:24px;backdrop-filter:blur(10px)}
input,select{width:100%;padding:16px;margin:6px 0;border-radius:12px;border:1px solid #ffffff22;background:#ffffff11;color:#fff;font-size:16px}
input::placeholder{color:#666}
select{appearance:none}
select option{background:#1a1a2e}
.btn{width:100%;padding:18px;margin-top:16px;border-radius:14px;border:none;background:linear-gradient(135deg,#e94560,#ff6b6b);color:#fff;font-size:18px;font-weight:700;cursor:pointer}
.btn:active{transform:scale(.98)}
.warn{margin-top:20px;padding:14px;background:#ffffff08;border-radius:12px;font-size:11px;color:#888;line-height:1.5}
.warn b{color:#e94560}
</style>
</head>
<body>
<div class="box">
  <div class="logo">ğŸº</div>
  <h1>AlcoTracker</h1>
  <p class="sub">Traccia il tuo tasso alcolemico</p>
  
  <div class="form">
    <input type="text" id="nome" placeholder="ğŸ‘¤ Nome">
    <input type="number" id="peso" placeholder="âš–ï¸ Peso (kg)" min="40" max="150">
    <select id="sesso">
      <option value="">ğŸš» Sesso</option>
      <option value="M">ğŸ‘¨ Uomo</option>
      <option value="F">ğŸ‘© Donna</option>
    </select>
    <button class="btn" onclick="go()">ğŸš€ INIZIA</button>
  </div>
  
  <div class="warn">
    âš ï¸ <b>Disclaimer:</b> Stime indicative. Il tasso reale dipende da molti fattori individuali. Non guidare se hai dubbi!<br><br>
    ğŸš— Limite Italia: <b>0.5 g/L</b> (0.0 neopatentati)
  </div>
</div>

<script type="module">
import{initializeApp}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import{getDatabase,ref,set,get}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const db=getDatabase(initializeApp({
  apiKey:"AIzaSyBxYLAaFJqFxHkZ2CVU3sFwUCEp60gis2U",
  databaseURL:"https://copilota-6d94a-default-rtdb.firebaseio.com",
  projectId:"copilota-6d94a"
}));

window.go=async()=>{
  const nome=document.getElementById('nome').value.trim();
  const peso=parseFloat(document.getElementById('peso').value);
  const sesso=document.getElementById('sesso').value;
  
  if(!nome||!peso||!sesso){alert('Compila tutto!');return;}
  
  const id=nome.toLowerCase().replace(/[^a-z0-9]/g,'')+'_'+Date.now();
  
  await set(ref(db,'alco/'+id),{nome,peso,sesso,food:'medio',createdAt:Date.now()});
  
  localStorage.setItem('alcoId',id);
  localStorage.setItem('alcoName',nome);
  
  location.href='app.html';
};

// Auto-redirect se giÃ  registrato
const id=localStorage.getItem('alcoId');
if(id){
  get(ref(db,'alco/'+id)).then(s=>{if(s.exists())location.href='app.html';});
}
</script>
</body>
</html>
